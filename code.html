<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Viewer Component Demo</title>
    <style>
        /* Code Viewer Component Styles */
        :root {
            --cv-bg-color: #1e1e1e;
            --cv-text-color: #d4d4d4;
            --cv-keyword-color: #569cd6;
            --cv-string-color: #ce9178;
            --cv-comment-color: #6a9955;
            --cv-function-color: #dcdcaa;
            --cv-number-color: #b5cea8;
            --cv-header-bg: #2d2d2d;
            --cv-border-color: #333;
            --cv-font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            --cv-copy-btn-bg: #333;
            --cv-copy-btn-hover: #444;
            --cv-copy-btn-text: #fff;
            --cv-success-color: #4caf50;
        }

        .code-viewer {
            font-family: var(--cv-font-family);
            background-color: var(--cv-bg-color);
            color: var(--cv-text-color);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
            border: 1px solid var(--cv-border-color);
            position: relative;
        }

        .code-viewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--cv-header-bg);
            padding: 8px 16px;
            border-bottom: 1px solid var(--cv-border-color);
        }

        .code-viewer-lang {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            color: #ccc;
            letter-spacing: 0.5px;
        }

        .code-viewer-copy-btn {
            background-color: var(--cv-copy-btn-bg);
            color: var(--cv-copy-btn-text);
            border: 1px solid #555;
            border-radius: 4px;
            padding: 4px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s ease;
            outline: none;
        }

        .code-viewer-copy-btn:hover {
            background-color: var(--cv-copy-btn-hover);
            border-color: #666;
        }

        .code-viewer-content {
            padding: 16px;
            overflow-x: auto;
            line-height: 1.5;
            margin: 0;
            tab-size: 2;
        }

        .code-viewer-content code {
            display: block;
            white-space: pre;
        }

        /* Syntax Highlighting */
        .cv-keyword {
            color: var(--cv-keyword-color);
            font-weight: bold;
        }

        .cv-string {
            color: var(--cv-string-color);
        }

        .cv-comment {
            color: var(--cv-comment-color);
            font-style: italic;
        }

        .cv-function {
            color: var(--cv-function-color);
        }

        .cv-number {
            color: var(--cv-number-color);
        }

        .cv-tag {
            color: var(--cv-keyword-color);
        }

        .cv-attribute {
            color: #9cdcfe;
        }

        .cv-selector {
            color: #d7ba7d;
        }

        .cv-property {
            color: #9cdcfe;
        }

        /* Animation for copy feedback */
        @keyframes fadeInOut {
            0% {
                opacity: 0;
                transform: translateY(5px);
            }

            20% {
                opacity: 1;
                transform: translateY(0);
            }

            80% {
                opacity: 1;
                transform: translateY(0);
            }

            100% {
                opacity: 0;
                transform: translateY(-5px);
            }
        }

        .copy-feedback {
            position: absolute;
            top: 40px;
            right: 16px;
            background-color: var(--cv-success-color);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            pointer-events: none;
            animation: fadeInOut 2s ease forwards;
            z-index: 10;
        }
    </style>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            padding: 20px;
            max-width: 900px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            margin-bottom: 30px;
        }
    </style>
</head>
<body>

<h1>Code Viewer Component</h1>

<div id="demo-js" class="container"></div>
<div id="demo-css" class="container"></div>
<div id="demo-html" class="container"></div>

<script>
    /**
     * Code Viewer Component
     * Displays code with syntax highlighting and copy-to-clipboard functionality.
     */
    class CodeViewer {
        constructor(container, options = {}) {
            this.container = typeof container === 'string' ? document.querySelector(container) : container;
            this.code = options.code || '';
            this.language = options.language || 'javascript';
            this.title = options.title || this.language;

            if (!this.container) {
                console.error('CodeViewer: Container not found');
                return;
            }

            this.render();
        }

        render() {
            this.container.innerHTML = '';

            // Create main wrapper
            const wrapper = document.createElement('div');
            wrapper.className = 'code-viewer';

            // Create header
            const header = document.createElement('div');
            header.className = 'code-viewer-header';

            const langLabel = document.createElement('span');
            langLabel.className = 'code-viewer-lang';
            langLabel.textContent = this.title;

            const copyBtn = document.createElement('button');
            copyBtn.className = 'code-viewer-copy-btn';
            copyBtn.textContent = 'Copy';
            copyBtn.onclick = () => this.copyToClipboard(copyBtn);

            header.appendChild(langLabel);
            header.appendChild(copyBtn);

            // Create code content
            const pre = document.createElement('pre');
            pre.className = 'code-viewer-content';

            const codeEl = document.createElement('code');
            codeEl.innerHTML = this.highlight(this.code, this.language);

            pre.appendChild(codeEl);

            // assemble
            wrapper.appendChild(header);
            wrapper.appendChild(pre);
            this.container.appendChild(wrapper);
        }

        copyToClipboard(btn) {
            navigator.clipboard.writeText(this.code).then(() => {
                // Show feedback
                btn.textContent = 'Copied!';

                // Optional: Add a floating feedback element
                const feedback = document.createElement('div');
                feedback.className = 'copy-feedback';
                feedback.textContent = 'Copied to clipboard!';
                this.container.querySelector('.code-viewer').appendChild(feedback);

                setTimeout(() => {
                    btn.textContent = 'Copy';
                    if (feedback.parentNode) {
                        feedback.parentNode.removeChild(feedback);
                    }
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy: ', err);
                btn.textContent = 'Error';
                setTimeout(() => btn.textContent = 'Copy', 2000);
            });
        }

        escapeHtml(unsafe) {
            return unsafe
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        highlight(code, lang) {
            let highlighted = this.escapeHtml(code);

            // Extremely basic regex-based highlighting
            // Note: This is not a full parser, just for demonstration

            if (lang === 'javascript' || lang === 'js') {
                // Keywords
                highlighted = highlighted.replace(/\b(const|let|var|function|class|return|if|else|for|while|import|export|from|async|await|new|this)\b/g, '<span class="cv-keyword">$1</span>');
                // Functions
                highlighted = highlighted.replace(/\b([a-zA-Z_$][a-zA-Z0-9_$]*)\s*(?=\()/g, '<span class="cv-function">$1</span>');
                // Strings
                highlighted = highlighted.replace(/'([^']*)'/g, '<span class="cv-string">\'$1\'</span>');
                highlighted = highlighted.replace(/"([^"]*)"/g, '<span class="cv-string">"$1"</span>');
                // Comments
                highlighted = highlighted.replace(/(\/\/.*)/g, '<span class="cv-comment">$1</span>');
            } else if (lang === 'css') {
                // Selectors (start of line or after })
                highlighted = highlighted.replace(/([#.]?[\w-]+)(?=\s*\{)/g, '<span class="cv-selector">$1</span>');
                // Properties
                highlighted = highlighted.replace(/([\w-]+)(?=\s*:)/g, '<span class="cv-attribute">$1</span>');
                // Values (not perfect)
                highlighted = highlighted.replace(/:\s*([^;]+);/g, ': <span class="cv-number">$1</span>;');
            } else if (lang === 'html') {
                // Tags
                highlighted = highlighted.replace(/&lt;(\/?[a-z0-9]+)(?![^&]*;)/gi, '&lt;<span class="cv-tag">$1</span>');
                // Attributes
                highlighted = highlighted.replace(/\s([a-z-]+)=/gi, ' <span class="cv-attribute">$1</span>=');
                // Attribute values
                highlighted = highlighted.replace(/="([^"]*)"/g, '="<span class="cv-string">$1</span>"');
                // Comments
                highlighted = highlighted.replace(/(&lt;!--.*?--&gt;)/s, '<span class="cv-comment">$1</span>');
            }

            return highlighted;
        }
    }

</script>
<script>
    // Demo 1: JavaScript
    const jsCode = `// Fetch data from API
async function fetchData(url) {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        const data = await response.json();
        return data;
    } catch (error) {
        console.error('Fetch error:', error);
    }
}`;

    new CodeViewer('#demo-js', {
        code: jsCode,
        language: 'javascript',
        title: 'JavaScript Example'
    });

    // Demo 2: CSS
    const cssCode = `.container {
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #ffffff;
    padding: 20px;
    border-radius: 8px;
}`;

    new CodeViewer('#demo-css', {
        code: cssCode,
        language: 'css',
        title: 'CSS Styling'
    });

    // Demo 3: HTML
    const htmlCode = `<!-- Main Container -->
<div class="card">
    <h2 class="title">Welcome</h2>
    <p>This is a sample paragraph.</p>
    <button onclick="alert('Hello')">Click Me</button>
</div>`;

    new CodeViewer('#demo-html', {
        code: htmlCode,
        language: 'html',
        title: 'HTML Structure'
    });
</script>
</body>
</html>
